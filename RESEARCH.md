# Research doc

### Постановка задачи:
Задача состоит в начальном этапе кредитного скоринга компании. Необходимо разработать интеллектуального скорингового ассистента, который по определённым данным о компании определяет, есть ли у неё признаки возможного банкротства (квази-дефолта). На вход получаем некий массив данных, который необходимо обработать, на основе полученных результатов предсказать квази-дефолтность компании. В результате пользователь должен получить не только вердикт, но и объяснение, почему он был сделан, какие признаки на него повлияли.

### Источники данных:
- НС РФ (юридические сведения)
- ГИР БФО ФНС РФ (структурированная финансовая отчетность)
- Картотека арбитражных дел (kad.arbitr.ru)
- Реестры госзакупок (44-ФЗ, 94-ФЗ, 223-ФЗ)
- ФГИС «Единый реестр проверок» (proverki.gov.ru)

### Выявление признаков:
Для каждой компании (по ```inn```):
1. ```organizations.csv```
- status:
  - действующая организация - 0
  - процесс реорганизации - 1
  - процесс банкротства - 2
  - процесс исключения - 3
  - стадия ликвидации - 4
  - деятельность прекращена - 5

Сразу не подходят: 3, 4, 5
- okved: (сфера деятельности) - категориальный признак

2. ```contracts.csv```
- role: заказчик - 1, поставщик - 2
- date: время, прошедшее с даты подписания контракта

3.  ```egrul.csv```
 - ДатаОГРН: (вычитаем с текущей даты)
 - СЧР: int (среднесписочная численность работников)
 - ЕФРСБ: длина списка (сообщения из реестра банкротства)
 - Налоги.СумУпл
 - Налоги.СумНедоим
 - УстКап.Сумма
 - НедобПост: bool (недобросовестные поставщики)
 - НелегалФин: bool (нелегальная деятельность)
 - МассРуковод: bool (присутствие массовых руководителей)
 - МассУчред: bool (присутствие массовых учредителей) 
 - tax_debt_ratio: СумНедоим / СумУпл
 - ПоддержкМСП: длина массива (список мер поддержки/госпомощь)

4. ```enforcements.csv```
- ИспПрДата:
- СумДолг
- ОстЗадолж

5.  ```finances.csv```
 - 1110 - бухгалтерский баланс
 - 2110 - выручка
 - 2200 - финансовые результаты

Коды. Берём как сумму за года (лучше взять, например, за последние 5 лет)

6. ```kad_arbitr.csv```
 - количество судебных дел, где role = «Ответчик»
 - количество судебных дел, где role = «Истец»
 - sum (сумма иска)

### Финансовые коэффициенты:

1. ```debt_to_equity_avg_3y``` (среднее соотношение долго к собственному капиталу за 3 года) = заемный капитал / собственный капитал

(заемный капитал = 1400 + 1500)

(собственный капитал = 1300)

Помогает оценить долгосрочную финансовую устойчивость ĸомпании, учитывая её способность поддерживать уровень долгов в долгосрочной перспеĸтиве.

2. ```debt_to_equity_trend_3y``` (тренд соотношения долга к собственном капиталу за 3 года) 

Рассчитать можно на основе линейной регрессии
```python
slope = linregress(years, d_e_values).slope
# где d_e_values = Debt/Equity = Заемный капитал / Собственный капитал
```

- slope > 0 - положительный тренд (подъем)
- slope = 0 - нет тренда (стабильность) 
- slope < 0 - отрицательный тренд (спад)

Изменение долга ĸ собственному ĸапиталу за 3 года. Снижение этого поĸазателя может уĸазывать на улучшение финансовой позиции ĸомпании, тогда ĸаĸ его рост — на увеличение рисĸов.

3. ```roa_avg_3y``` (Средняя ROA за 3 года) = чистая прибыль/средние активы

чистая прибыль = 2400 

средние активы = (активы на начало + активы на конец) / 2

активы на начало = 1100(начало) + 1200(начало)

активы на конец = 1100(конец) + 1200(конец)

(активы = внеоборотные + оборотные = 1100 + 1200)

Средний поĸазатель рентабельности аĸтивов за последние 3 года. Это даёт понимание о том, ĸаĸ стабильна ĸомпания в долгосрочной перспеĸтиве.

### Ход работы:

- 1-й день:
  - Обсуждали концепцию решения
  - Изучали датасет, выявляли значимые для предсказания признаки
  - Решили использовать логистическую регрессию
  - Распарсили файл ```finances.csv```
- 2-й день:
  - Подробно изучали структуру финансовой отчётности
  - Начали изучать финансовые коэффициенты 
  - Исследовали практики кредитного скоринга других банков
- 3-й день:
  - Разработали архитектуру и диаграмму последовательностей
  - Изучали структуру ЕГРЮЛ, определяли важность закупок и иных данных
  - Обучили модель на основе одного распаршенного файла, протестировали на тестовом датасете, анализировали полученные результаты (промежуточные в рамках всего проекта)
  - Распарсили ещё два файла данных
- 4-й день:
  - Выяснили, что HGBoost обучается лучше,
  - Распарсили все данные
  - С учетом всех выбранных признаков обучили модель
  - <...>
